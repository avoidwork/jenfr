{"version":3,"sources":["jenfr.js"],"names":["global","deferred","promise","resolver","rejecter","Promise","resolve","reject","jenfr","target","uri","arguments","length","undefined","options","height","width","scale","defer","offset","left","top","ratio","map","invalid","canvas","ctx","frag","img","Element","TypeError","Object","document","createElement","setAttribute","forEach","i","isNaN","Math","floor","createDocumentFragment","appendChild","keys","attribute","test","getContext","fillStyle","fillRect","drawImage","window","requestAnimationFrame","version","exports","module","define","amd"],"mappings":";;AASA,cAEA,SAAWA,GAGV,QAASC,KACR,GAAIC,GAAU,OACVC,EAAW,OACXC,EAAW,MAOf,OALAF,GAAU,GAAIG,SAAQ,SAAUC,EAASC,GACxCJ,EAAWG,EACXF,EAAWG,KAGHD,QAASH,EAAUI,OAAQH,EAAUF,QAASA,GAGxD,QAASM,GAAMC,GACd,GAAIC,GAAMC,UAAUC,QAAU,GAAsBC,SAAjBF,UAAU,GAAmB,GAAKA,UAAU,GAC3EG,EAAUH,UAAUC,QAAU,GAAsBC,SAAjBF,UAAU,IAAqBI,OAAQ,IAAKC,MAAO,IAAKC,OAAO,GAASN,UAAU,GAErHO,EAAQjB,IACRkB,GAAWC,KAAM,EAAGC,IAAK,GACzBC,GAAUP,OAAQ,EAAGC,MAAO,GAC5BC,EAAQ,EACRM,GAAQP,MAAO,OAAQD,OAAQ,OAC/BS,GAAU,EACVC,EAAS,OACTC,EAAM,OACNC,EAAO,OACPC,EAAM,MAuEV,QArEKnB,YAAkBoB,WACtBL,GAAU,EACVN,EAAMX,OAAO,GAAIuB,WAAU,iCAGvBN,GAA0B,gBAARd,KACtBc,GAAU,EACVN,EAAMX,OAAO,GAAIuB,WAAU,6BAGvBN,IAAYV,YAAmBiB,UACnCP,GAAU,EACVN,EAAMX,OAAO,GAAIuB,WAAU,iCAGvBN,IACAd,IACHkB,EAAMI,SAASC,cAAc,OAC7BL,EAAIM,aAAa,MAAOxB,GAEpBI,EAAQG,OAASH,EAAQC,QAAUD,EAAQE,QAAUY,EAAIb,OAASD,EAAQC,QAAUa,EAAIZ,MAAQF,EAAQE,SAC3GM,EAAMP,OAASD,EAAQC,OAASa,EAAIb,OACpCO,EAAMN,MAAQF,EAAQE,MAAQY,EAAIZ,MAClCC,EAAQK,EAAMP,OAASO,EAAMN,MAAQM,EAAMP,OAASO,EAAMN,QAG1D,SAAU,SAASmB,QAAQ,SAAUC,GACjCC,MAAMvB,EAAQsB,IACjBtB,EAAQsB,GAAKR,EAAIQ,GACPtB,EAAQG,OAClBW,EAAIM,aAAaE,EAAGR,EAAIQ,GAAKnB,GAC7BE,EAAOI,EAAIa,IAAME,KAAKC,OAAOzB,EAAQsB,GAAKR,EAAIQ,IAAM,IAEpDR,EAAIM,aAAaE,EAAGtB,EAAQsB,OAK/BT,EAAOK,SAASQ,yBAChBf,EAASO,SAASC,cAAc,UAChCN,EAAKc,YAAYhB,GAEjBM,OAAOW,KAAK5B,GAASqB,QAAQ,SAAUC,GAClCO,EAAUC,KAAKR,IAClBX,EAAOS,aAAaE,EAAGtB,EAAQsB,MAI7BX,EAAOoB,YACVnB,EAAMD,EAAOoB,WAAW,MAEpB/B,EAAQgC,YACXpB,EAAIoB,UAAYhC,EAAQgC,UACxBpB,EAAIqB,SAAS,EAAG,EAAGtB,EAAOT,MAAOS,EAAOV,SAGrCa,GACHF,EAAIsB,UAAUpB,EAAKT,EAAOC,KAAMD,EAAOE,IAAKO,EAAIZ,MAAOY,EAAIb,SAElDa,GACVH,EAAOgB,YAAYb,GAGpBqB,OAAOC,sBAAsB,WAC5BzC,EAAOgC,YAAYd,GACnBT,EAAMZ,SAASmB,EAAQC,EAAKE,OAIvBV,EAAMhB,QAnGd,GAAIyC,GAAY,kJAsGhBnC,GAAM2C,QAAU,QAGO,mBAAZC,SACVC,OAAOD,QAAU5C,EACW,kBAAX8C,SAAyBA,OAAOC,IACjDD,OAAO,WACN,MAAO9C,KAGRR,EAAOQ,MAAQA,GAEI,mBAAXyC,QAAyBA,OAASjD","file":"jenfr.min.js","sourcesContent":["/**\r\n * Canvas based image loader\r\n *\r\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @copyright 2016\r\n * @license BSD-3-Clause\r\n * @link http://avoidwork.github.io/jenfr\r\n * @version 1.0.1\r\n */\n\"use strict\";\n\n(function (global) {\n\tvar attribute = /^(className|draggable|height|hidden|id|offsetHeight|offsetWidth|offsetLeft|offsetTop|scrollHeight|scrollLeft|scrollTop|scrollWidth|title|width)$/;\n\n\tfunction deferred() {\n\t\tvar promise = void 0,\n\t\t    resolver = void 0,\n\t\t    rejecter = void 0;\n\n\t\tpromise = new Promise(function (resolve, reject) {\n\t\t\tresolver = resolve;\n\t\t\trejecter = reject;\n\t\t});\n\n\t\treturn { resolve: resolver, reject: rejecter, promise: promise };\n\t}\n\n\tfunction jenfr(target) {\n\t\tvar uri = arguments.length <= 1 || arguments[1] === undefined ? \"\" : arguments[1];\n\t\tvar options = arguments.length <= 2 || arguments[2] === undefined ? { height: 100, width: 100, scale: true } : arguments[2];\n\n\t\tvar defer = deferred(),\n\t\t    offset = { left: 0, top: 0 },\n\t\t    ratio = { height: 0, width: 0 },\n\t\t    scale = 1,\n\t\t    map = { width: \"left\", height: \"top\" },\n\t\t    invalid = false,\n\t\t    canvas = void 0,\n\t\t    ctx = void 0,\n\t\t    frag = void 0,\n\t\t    img = void 0;\n\n\t\tif (!target instanceof Element) {\n\t\t\tinvalid = true;\n\t\t\tdefer.reject(new TypeError(\"`target` must be an Element\"));\n\t\t}\n\n\t\tif (!invalid && typeof uri !== \"string\") {\n\t\t\tinvalid = true;\n\t\t\tdefer.reject(new TypeError(\"`uri` must be a String\"));\n\t\t}\n\n\t\tif (!invalid && !options instanceof Object) {\n\t\t\tinvalid = true;\n\t\t\tdefer.reject(new TypeError(\"`options` must be an Object\"));\n\t\t}\n\n\t\tif (!invalid) {\n\t\t\tif (uri) {\n\t\t\t\timg = document.createElement(\"img\");\n\t\t\t\timg.setAttribute(\"src\", uri);\n\n\t\t\t\tif (options.scale && options.height && options.width && (img.height > options.height || img.width > options.width)) {\n\t\t\t\t\tratio.height = options.height / img.height;\n\t\t\t\t\tratio.width = options.width / img.width;\n\t\t\t\t\tscale = ratio.height < ratio.width ? ratio.height : ratio.width;\n\t\t\t\t}\n\n\t\t\t\t[\"height\", \"width\"].forEach(function (i) {\n\t\t\t\t\tif (isNaN(options[i])) {\n\t\t\t\t\t\toptions[i] = img[i];\n\t\t\t\t\t} else if (options.scale) {\n\t\t\t\t\t\timg.setAttribute(i, img[i] * scale);\n\t\t\t\t\t\toffset[map[i]] = Math.floor((options[i] - img[i]) / 2);\n\t\t\t\t\t} else {\n\t\t\t\t\t\timg.setAttribute(i, options[i]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfrag = document.createDocumentFragment();\n\t\t\tcanvas = document.createElement(\"canvas\");\n\t\t\tfrag.appendChild(canvas);\n\n\t\t\tObject.keys(options).forEach(function (i) {\n\t\t\t\tif (attribute.test(i)) {\n\t\t\t\t\tcanvas.setAttribute(i, options[i]);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (canvas.getContext) {\n\t\t\t\tctx = canvas.getContext(\"2d\");\n\n\t\t\t\tif (options.fillStyle) {\n\t\t\t\t\tctx.fillStyle = options.fillStyle;\n\t\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t\t}\n\n\t\t\t\tif (img) {\n\t\t\t\t\tctx.drawImage(img, offset.left, offset.top, img.width, img.height);\n\t\t\t\t}\n\t\t\t} else if (img) {\n\t\t\t\tcanvas.appendChild(img);\n\t\t\t}\n\n\t\t\twindow.requestAnimationFrame(function () {\n\t\t\t\ttarget.appendChild(frag);\n\t\t\t\tdefer.resolve([canvas, ctx, img]);\n\t\t\t});\n\t\t}\n\n\t\treturn defer.promise;\n\t}\n\n\tjenfr.version = \"1.0.1\";\n\n\t// Node, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = jenfr;\n\t} else if (typeof define === \"function\" && define.amd) {\n\t\tdefine(function () {\n\t\t\treturn jenfr;\n\t\t});\n\t} else {\n\t\tglobal.jenfr = jenfr;\n\t}\n})(typeof window !== \"undefined\" ? window : global);\n"]}