{"version":3,"sources":["jenfr.js"],"names":["_toConsumableArray","arr","Array","isArray","i","arr2","length","from","global","deferred","promise","resolver","rejecter","Promise","resolve","reject","jenfr","target","next","img","options","scale","height","width","ratio","forEach","isNaN","setAttribute","offset","map","Math","floor","frag","document","createDocumentFragment","canvas","createElement","appendChild","getContext","ctx","drawImage","left","top","obj","odx","Object","keys","preset","test","hasAttribute","apply","window","requestAnimationFrame","defer","uri","arguments","undefined","invalid","Element","TypeError","onload","version","exports","module","define","amd"],"mappings":"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","file":"jenfr.min.js","sourcesContent":["/**\r\n * Canvas based image loader\r\n *\r\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @copyright 2016\r\n * @license BSD-3-Clause\r\n * @link http://avoidwork.github.io/jenfr\r\n * @version 1.0.2\r\n */\n\"use strict\";\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n(function (global) {\n\tvar preset = /^(drawImage|height|scale|width)$/;\n\n\tfunction deferred() {\n\t\tvar promise = void 0,\n\t\t    resolver = void 0,\n\t\t    rejecter = void 0;\n\n\t\tpromise = new Promise(function (resolve, reject) {\n\t\t\tresolver = resolve;\n\t\t\trejecter = reject;\n\t\t});\n\n\t\treturn { resolve: resolver, reject: rejecter, promise: promise };\n\t}\n\n\tfunction jenfr(target) {\n\t\tvar uri = arguments.length <= 1 || arguments[1] === undefined ? \"\" : arguments[1];\n\t\tvar options = arguments.length <= 2 || arguments[2] === undefined ? { height: 100, width: 100, scale: true } : arguments[2];\n\n\t\tvar defer = deferred(),\n\t\t    offset = { left: 0, top: 0 },\n\t\t    ratio = { height: 0, width: 0 },\n\t\t    scale = 1,\n\t\t    map = { width: \"left\", height: \"top\" },\n\t\t    invalid = false,\n\t\t    canvas = void 0,\n\t\t    ctx = void 0,\n\t\t    frag = void 0,\n\t\t    img = void 0;\n\n\t\tif (!target instanceof Element) {\n\t\t\tinvalid = true;\n\t\t\tdefer.reject(new TypeError(\"`target` must be an Element\"));\n\t\t}\n\n\t\tif (!invalid && typeof uri !== \"string\") {\n\t\t\tinvalid = true;\n\t\t\tdefer.reject(new TypeError(\"`uri` must be a String\"));\n\t\t}\n\n\t\tif (!invalid && !options instanceof Object) {\n\t\t\tinvalid = true;\n\t\t\tdefer.reject(new TypeError(\"`options` must be an Object\"));\n\t\t}\n\n\t\tfunction next() {\n\t\t\tif (img) {\n\t\t\t\tif (options.scale && options.height && options.width && (img.height > options.height || img.width > options.width)) {\n\t\t\t\t\tratio.height = options.height / img.height;\n\t\t\t\t\tratio.width = options.width / img.width;\n\t\t\t\t\tscale = ratio.height < ratio.width ? ratio.height : ratio.width;\n\t\t\t\t}\n\n\t\t\t\t[\"height\", \"width\"].forEach(function (i) {\n\t\t\t\t\tif (isNaN(options[i])) {\n\t\t\t\t\t\toptions[i] = img[i];\n\t\t\t\t\t} else if (options.scale) {\n\t\t\t\t\t\timg.setAttribute(i, img[i] * scale);\n\t\t\t\t\t\toffset[map[i]] = Math.floor((options[i] - img[i]) / 2);\n\t\t\t\t\t} else {\n\t\t\t\t\t\timg.setAttribute(i, options[i]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfrag = document.createDocumentFragment();\n\t\t\tcanvas = document.createElement(\"canvas\");\n\t\t\tfrag.appendChild(canvas);\n\t\t\tcanvas.setAttribute(\"height\", options.height);\n\t\t\tcanvas.setAttribute(\"width\", options.width);\n\n\t\t\tif (canvas.getContext) {\n\t\t\t\tctx = canvas.getContext(\"2d\");\n\n\t\t\t\tif (img) {\n\t\t\t\t\tctx.drawImage(img, offset.left, offset.top, img.width, img.height);\n\t\t\t\t}\n\n\t\t\t\t[canvas, ctx].forEach(function (obj, odx) {\n\t\t\t\t\tObject.keys(options).forEach(function (i) {\n\t\t\t\t\t\tif (!preset.test(i)) {\n\t\t\t\t\t\t\tif (odx === 0 && obj.hasAttribute(i)) {\n\t\t\t\t\t\t\t\tobj.setAttribute(i, options[i]);\n\t\t\t\t\t\t\t} else if (typeof obj[i] === \"function\") {\n\t\t\t\t\t\t\t\tobj[i].apply(obj, _toConsumableArray(options[i]));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else if (img) {\n\t\t\t\tcanvas.appendChild(img);\n\t\t\t}\n\n\t\t\twindow.requestAnimationFrame(function () {\n\t\t\t\ttarget.appendChild(frag);\n\t\t\t\tdefer.resolve([canvas, ctx, img]);\n\t\t\t});\n\t\t}\n\n\t\tif (!invalid) {\n\t\t\tif (uri) {\n\t\t\t\timg = document.createElement(\"img\");\n\t\t\t\timg.onload = next;\n\t\t\t\timg.setAttribute(\"src\", uri);\n\t\t\t} else {\n\t\t\t\tnext();\n\t\t\t}\n\t\t}\n\n\t\treturn defer.promise;\n\t}\n\n\tjenfr.version = \"1.0.2\";\n\n\t// Node, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = jenfr;\n\t} else if (typeof define === \"function\" && define.amd) {\n\t\tdefine(function () {\n\t\t\treturn jenfr;\n\t\t});\n\t} else {\n\t\tglobal.jenfr = jenfr;\n\t}\n})(typeof window !== \"undefined\" ? window : global);\n"]}